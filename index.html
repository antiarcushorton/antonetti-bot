<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" charset="UTF-8">
        <title>Antonetti Bot</title>
        <link rel="stylesheet" href="styles.css">
        <link rel="icon" type="image/png" href="images/baseball.png">
    </head>
    <body>
        <div class="image-row">
            <img src="images/antonetti.jpg" alt="Photo 1" class="fade-image">
            <img src="images/chernoff.jpg" alt="Photo 2" class="fade-image">
            <img src="images/dolan.jpg" alt="Photo 3" class="fade-image">
        </div>
        <script src="images.js"></script>
        <h3 class="header">What do Chris Antonetti, Mike Chernoff, and Paul Dolan have to say during the offseason?</h3>
        <a class="card" id="card" target="_blank" rel="noopener noreferrer">
            <div class="quote" id="quote"></div>
            <div class="attribution" id="attribution"></div>
        </a>
        <button id="new-quote-button">Hear from the fellas</button>

        <script type="module">
          import { quotes } from './quotes.js';

          // Store last 25 indices
          let recentIndices = [];
          
          // Set first index and add to list
          let lastIndex = quotes.findIndex(q =>
            q.quote.includes("most boring")
          );
          if (lastIndex !== -1) {
            recentIndices.push(lastIndex);
          }

          let currentLink = "";

          const card = document.getElementById("card");
          const quoteElement = document.getElementById("quote");
          const attributionElement = document.getElementById("attribution");
          const newQuoteButton = document.getElementById("new-quote-button");

          // Show a quote
          function showQuote(index) {
            const q = quotes[index];
            quoteElement.innerText = q.quote;
            attributionElement.innerText = q.attribution;
            currentLink = q.link;
            card.href = currentLink;
          }

          // Generate a new random quote
          function newQuote() {
            card.classList.add("fade-out");

            setTimeout(() => {
              let index;
              // Keep picking until new quote not in list
              do {
                index = Math.floor(Math.random() * quotes.length);
              } while (recentIndices.includes(index));

              lastIndex = index;

              // Add to recent list
              recentIndices.push(index);

              // Keep only last 25
              if (recentIndices.length > 25) {
                recentIndices.shift(); // removes oldest
              }

              showQuote(index);

              card.classList.remove("fade-out");
            }, 400);
          }

          // Event listeners
          newQuoteButton.addEventListener("click", newQuote);

          // Load the first quote immediately
          showQuote(lastIndex);

        </script>
    </body>
</html>
